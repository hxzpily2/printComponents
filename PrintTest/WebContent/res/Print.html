<!doctype html>
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<title>打印测试</title>
		<style>
			*{margin:0;padding:0;}
			html,body{width:100%;height:100%;overflow-y:hidden;}
		</style>
	</head>
	<body>
		<object id="Nova"  name="Nova" 
			  type="application/x-shockwave-flash" data="Nova.swf" width="100%" height="100%">
			    <param name="movie" value="Nova.swf"/>
			    <param name="quality" value="high"/>
			    <param name="allowscriptaccess" value="always"/>
			    <a href="http://www.adobe.com/go/getflash">
			        <img src="http://www.adobe.com/images/shared/download_buttons/get_flash_player.gif" alt="Get Adobe Flash player"/>
			    </a>
		  </object>
		 <script type="text/javascript" src="../js/jquery.js"></script>
		  <script type="text/javascript">
		 	 var loadIx=0;
		  	  //swf已经创建完毕
			  function AsCreatComplete()
			  {
				  loadXml("file/coverSet.xml",function(xml){
					  thisMovie("Nova").getSetting(xml);
					  sendLayout();
				  })
			  }
		  	  //发送layout
		  	  function sendLayout()
		  	  {
		  		loadXml("file/printLayout.xml",function(xml){
					  thisMovie("Nova").getLayout(xml);
					  sendData();
				  })
		  	  }
		  	  //发送data
		  	  function sendData()
		  	  {
		  		 loadXml("file/printData.xml",function(xml){
					  thisMovie("Nova").getData(xml);
					  sendProperties();
				  })
		  	  }
		  	 //发送打印设置
		  	  function sendProperties()
		  	  {
		  		 loadXml("file/printSet.xml",function(xml){
					 thisMovie("Nova").getProperties(xml);
				  })
		  	  }
		  	  function loadXml(requestUrl,successHandler)
		  	  {
		  		  $.ajax({
		  			 url: requestUrl,
		  			 type: "POST",
                     dataType: "text",
                     success:successHandler
		  		  })
		  	  }
		  	  
			  function thisMovie(movieName)
			  {   
		         if(navigator.appName.indexOf("Microsoft")!=-1)
		         {   
		            return window[movieName];   
		         }else
		         {   
		             return document[movieName];   
		         }   
			  } 
		  </script>
	</body>
</html>